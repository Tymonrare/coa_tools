# coa_tools_ui_examples

# Editors

## Именования слоев

В каждом редакторе одни правила именования:

1. Первое слово - id слоя, должно быть уникальным для своей группы, разрешаются нижние подчеркивания. Альтернативно можно указать параметр `id=name`
2. Параметры задаются через `param=value` или `--param`, в первом случае параметру присваивается следующее после знака равно значение, во втором булевое значение

## Группы слоев

1. По умолчанию все слои, находящиеся в группе (Папке), будут объединены до одного слоя
2. Для того чтобы работать с папкой как с группой, ей надо добавить флаг `--group`
3. Для экспорта группы как кадры анимации надо указать флаг `--frames`
4. Для экспорта группы как батча спрайтов указать `--batch`

## Вложенные группы

Для некоторых параметров, например `target_tab` необходимо указывать полный путь через все группы, например:

    - (folder) group1 --group
    --- (folder) group2 --group
    --- --- (folder) group3 --group

    - (button) btn1 target_tab=group1.group2.group3

## Объекты UI

**Кнопки**

Для создания кнопки в названия слоя вписать `type=btn`

Для создания кнопки с состояниями (ожидание, наведение, клик) добавляется группа слоев:

    - (folder) your_btn type=btn --frames
    --- (layer) idle
    --- (layer) hover
    --- (layer) click
    --- (layer) disabled

Можно выборочно не указывать hover, click и disabled.
Можно создать кнопку просто одним слоем, `(layer) your_btn type=btn`

Поддерживает два режима - simple и switch (mode=simple или mode=switch). simple можно не указывать явно, это режим по умолчанию

Для режима switch каждое нажатие будет переключать кнопку во вкл/выкл, и рассылать эвент:

```javascript

	let btn = ui.nodes.btn;
	btn.on('switchtoggle', funtion(toggle){
		//toggle == true при вкл
	});
```

other:

```javascript

	let btn = ui.nodes.btn;
	btn.label = "Your text";
	btn.interactive = false; //if button has 'disabel' frame it will be set
```

**_Анимация кнопок_**

По умолчанию на каждый указанный кадр (idle статичный, hover наведение, click нажатие, disabled отключение) переключается спрайт кнопки при взаимодействиях. Отдельно можно указать анимацию (В дальнейшем будет расширено):

- `animation=simple_btn`, тогда кнопка будет анимироваться при наведениях и нажатиях

**Шкала прогресса**

Для создания шкалы прогресса добавляется группа слоев:

    - (folder) your_progress type=progress --frames
    --- (layer) bar
    --- (layer) body

Где:

- bar - сама шкала
- body - статичная оболочка

Для шкалы можно указать `progress_anchor=x,y` что привяжет бар к определенному углу,
по умолчанию он заполняется слева направо, но если указать `progress_anchor=1,0.5`, то заполнение будет справа налево

**Ползунок прокрутки**

Для создания шкалы прокрутки добавляется группа слоев:

    - (folder) your_scroll type=scroll_bar --group
    --- (layer|group) btn type=btn
    --- (layer|group) body (type=progress)

Кнопка (btn) стандартно может быть как слоем так и отдельной папкой со своими состояниями
Тело (body) выполняет две функции - определяет диапазон и направление перемещения ползунка и в случае, если это type=progress, заполняется по положению ползунка
    
По аналогии со шкалой прогресса допускается свойство `scroll_anchor=x,y`, определяющее "начало" и "конец" прокрутки. По умолчанию используется направление слева-направо
Бинд - функция, вызываемая при движении ползунка

```javascript

scroll.binding = function(val){
	//val - в диапазоне 0-1
	//будет вызван каждый раз при движении ползунка
}
```

**Вкладки**

Для создания вкладок требуется описать несколько групп и кнопок ими управляющих:

    - (folder) tab1 node_group=example_tabs --group
    --- ...content
    - (folder) tab2 node_group=example_tabs --group
    --- ...content

    - (button) btn1 target_tab=tab1
    - (button) btn2 target_tab=tab2

Т.е.:

- Для каждой вкладки указывается своя кнопка, с параметром `target_tab=имя_вкладки`
- В одно время будет показываться только одна вкладка из `node_group`

**Radio group**

Аналог https://www.w3schools.com/html/tryit.asp?filename=tryhtml_form_radio

```
- (folder) radio type=radio_group --frames
--- (layer) disabled
--- (layer) selected
```

Поддерживает `style=dir-h` и `style=dir-v` для горизонтального и вертикального расположения.

Код:

```javascript
let rGroup = nodes.your_radio_group;
rGroup.setLength(5); //make 5 checkboxes
rGroup.setSelected(1); //preselect second box
rGroup.on("checkselected", function(index) {
  console.log(index); //listen selects
});
```

**Разметочные зоны**

Для некоторых типов слоев указывается только зона разметки, при этом подразумевается что сами данные уже будут заданы в коде

**_Sprite area_**

Зона спрайта, указывается флагом `type=sprite_area`. Флагами `style=` через запятую указывается стили данных, например `style=save_ratio,center` сохраняет пропорции изображения (Вписывая спрайт в зону) и центрует.
Доступные стили:

- save_ratio - вписывает спрайт с сохранением пропорций
- fit - вписывает спрайт в зону полностью
- center top bottom left right - привязка к определенной стороне для save_ratio спрайтов

**_Text area_**

Зона текста, указывается `type=text_area`. Флагом `font=fontName` указываем id стиля текста (Сами стили задаются отдельно)
[Генератор стилей pixi](https://pixijs.io/pixi-text-style/#)

```javascript
let ui = new coa.ui(
  conf,
  { fonts: { fontName: {} } } //PIXI style text
); //create window
```

Для центрирования задается отдельный флаг `pivot=x,y`, значения в диапазоне 0-1, например `pivot=0,0.5` центрует текст по левому краю. y можно не указывать, тогда будет использовано значение x

**_Сontainer_**

Контейнер для дублируемых элементов, указывается `type=container --group` для папки. Должен содержать два объекта внутри:

- area (Можно ее скрыть повесив флаг --hide или --ignore) эта зона, в которой будут создаваться копии node
- node. Референс дублируемого элемента. Может быть как одним слоем, так и группой слоев. При этом внутри группы поддерживаются text и sprite area. Важно не забывать при использовании группы внутри контейнера, что все имена слоев внутри него (Даже если они вложены в разные группы) должны быть уникальными.
  Дополнительно поддерживает элементы:
- btn_next. Должен быть `type=btn`. И только при условии что в контейнере включен скролл. Мотает контейнер на страницу вперед
- btn_prev. Мотает на страницу назад
- page_select. Должен быть `type=radio_group`.


*** Стили контейнеров ***

- `scroll-h` и `scroll-v`, прокрутка горизонтально и вертикально соответсвенно. Можно форсировать горизонтальный или вертикальный размер сетки свойствами `grid_w=2` и `grid_h=3` выставит ширину в 2 клетки и высоту в 3
- `page-h` и `page-v`, будет распологать все элементы на одной странице, равномерно распределяя по всему размеру area. Можно указать `page-h-3`, где 3 - кол-во элементов, располагаемых по вертикали. В таком случае необходимо скомбинировать со свойством `scroll-v`, для возможности отображения элементов по 3 на странице и сколлом

## Photoshop

**Установка**

Скачать скрипт в C:\Program Files\Adobe\Adobe Photoshop CC (2015)\Presets\Scripts (Правой кнопкой по странице→сохранить как)

[BlenderExporter.jsx](https://raw.githubusercontent.com/Tymonrare/coa_tools/master/tools/Photoshop/BlenderExporter.jsx)

**Экспорт**

1. Выделить все необходимые слои, ненужные скрыть
2. Открыть File → Scripts → BlenderExporter.jsx
3. Указать путь экспорта, понятное название
4. Нажать export, ждать пока закончатся операции

**Пример проекта**:

[test-coa-ui.psd](../test/sample/test-ui.psd)

# Code

## PIXI

После загрузки конфига по [примеру](https://github.com/Tymonrare/coa_tools/blob/master/engines/PIXI/coa_importer/README.md#usage) нам будут доступны все экспортированные объекты по имени их экспорта

    let ui = new coa.ui(conf);
    ui.layer_name; //Для слоя экспортированного под именем layer_name
    ui.group_name.layer_name; //Для вложенных слоев
    ui.gnodes.global_name //Для слоев экспортированных с флагом --global
    ui.gbinds.global_name = "value" //Для интерактивных --global элементов напрямую можно задавать значения
    ui.gbinds.list = [{text_area:"text", sprite_area:"srite", btn:function(){}}]; //Для --global контейнеров можно задавать массив, поля каждого объекта задают данные для элементов контейнера (Имя поля привязывается к имени слоя без учета вложенности). Поддерживаются тексты, спрайты и каллбеки кнопок
    ui.gbinds.list.push({..}); //Можно работать с этим массивом дальше
